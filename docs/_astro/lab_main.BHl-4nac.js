import{k as O,F as S,a as L,p as C,S as z,b as F,I as N,V as $,g as R,s as j,d as T,o as V,C as x,c as P}from"./konsole.1Z1AgOxG.js";const r=document.getElementById("code_exec"),g=document.getElementById("next_exec");document.getElementById("inject_btn");document.getElementById("visualizer_btn");const I=document.getElementById("refresh_btn");document.getElementById("all_breakpoints");const m=document.getElementById("stop_exec");document.getElementById("dynamic_btn");document.getElementById("save_btn");document.getElementById("open_btn");async function A(e,t,n,i,o){await v(e,t,n,i,o),window.konsole=O(console),window._lineInfo=D,window._line_Info_Hook=q,window._on_end_execution=G,window._Frame_Creation=S,window._Frame_Deletion=L;const s=document.getElementById("_ScriptNode");s&&s.parentElement.removeChild(s);const c=document.createElement("script");try{c.id="_ScriptNode",c.type="module",console.log(`

------------ Executing code --------------

`),c.textContent=t.code,document.body.appendChild(c)}catch(a){console.log(a),document.body.removeChild(c),r.disabled=!1,r.classList.remove("executing"),I.disabled=!1,g.disabled=!0,m.disabled=!0}}async function v(e,t,n,i,o){j.dynamic=o,console.clear();let s=e.code;const c=[],a=C(s,{ecmaVersion:"latest",onComment:c,allowAwaitOutsideFunction:!0});n.ast=a,n.OnRefreshTree(),z(a),F(a,window.always_break),N(a),console.log(a),console.log("Visit ast...");const B=await $(a,c,e,i);console.log("Code generation...");const h=R(B);t.setCode(h)}async function H(e,t,...n){const i=window.konsole;i.log(`Test case : ${e.name}(${n.join(",")})`);const o=await e(...n);let s="red";String(o)==String(t)&&(s="green"),i.colored(`Result : ${o}, expected : ${t}`,s)}async function D(e,t,n=!1){if(await window._line_Info_Hook(e,t),n){g.disabled=!1,m.disabled=!1,window.Editor.highlightLine(e),window.visualizer.On_Refresh_Stack(),window.operationPromise=new Promise(o=>{window.resolveOperation=o});const i=await window.operationPromise;if(i.status!="continue")throw new Error(i.message);m.disabled=!0,window.Editor.deHilightLastLine()}}async function q(e,t){const n=window.Editor;if(!n)throw new Error("lineInfo : Editor not found");n.deHilightLastLine(),n.getLineElement(e)}async function G(){window.visualizer.On_Refresh_Stack(),r.disabled=!1,g.disabled=!0,r.classList.remove("executing"),I.disabled=!1,console.log(`
------------ Execution ended --------------`)}function J(e,t){try{window.localStorage.setItem(e,t),console.log(`Stringa salvata con successo con la chiave: "${e}"`)}catch(n){console.error("Errore durante il salvataggio nel localStorage:",n)}}function K(e){try{return window.localStorage.getItem(e)}catch(t){console.error("Errore durante la lettura dal localStorage:",t);return}}let l,b,_;const M=document.getElementById("editor_div"),y=document.getElementById("debug_editor_div"),k=document.getElementById("visualizer"),Q=document.getElementById("code_exec");Q.onclick=ee;const U=document.getElementById("next_exec");U.onclick=te;const E=document.getElementById("inject_btn");E.onclick=oe;const p=document.getElementById("visualizer_btn");p.onclick=se;const W=document.getElementById("refresh_btn");W.onclick=ie;const w=document.getElementById("all_breakpoints");w.onclick=ae;const X=document.getElementById("stop_exec");X.onclick=ne;const f=document.getElementById("dynamic_btn");f.onclick=ce;const Y=document.getElementById("save_btn");Y.onclick=le;const Z=document.getElementById("open_btn");Z.onclick=de;async function ee(){J(document.title,l.code),await A(l,b,_,u,d)}async function te(){if(!window.resolveOperation)throw new Error("No code blocked!");window.resolveOperation({status:"continue"})}async function ne(){if(!window.resolveOperation)throw new Error("No code blocked!");window.resolveOperation({status:"stopped",message:"Execution was stopped by user"})}async function oe(){E.disabled=!0,p.disabled=!1,k.classList.add("closed"),y.classList.remove("closed")}async function se(){p.disabled=!0,E.disabled=!1,y.classList.add("closed"),k.classList.remove("closed")}async function ie(){await v(l,b,_,u,d)}let d=!1;async function ce(){d=!d,d?f.childNodes[0].textContent="ðŸ‘‹":f.childNodes[0].textContent="ðŸ¤š"}window.always_break=!1;async function ae(){window.always_break=!window.always_break,window.always_break?w.style.setProperty("background-color","red"):w.style.removeProperty("background-color")}async function le(){T(l.code,"file.js")}async function de(){const e=await V();l.setCode(e)}let u=`
_test(f, 4, 2, 2);
_test(f, 8, 4, 4);
`;async function re(e,t=u){u=t;const n=K(document.title);n&&(e=n),l=x(M,e),window.Editor=l,window._test=H,b=x(y,e),_=new P("visualizer"),window.visualizer=_}async function me(){const e=document.getElementById("file_input");e.onchange=_e}async function _e(e){const t=e.target;if(!t.files||t.files.length===0)return new Error("Nessun file selezionato.");const n=t.files[0],i=t.files[0].name,o=new FileReader;o.onload=s=>{if(s.target&&typeof s.target.result=="string"){const c=s.target.result.split("#test_cases"),a=document.getElementById("obfuscate");a.parentElement.removeChild(a),document.title=i,re(c[0],c[1]);return}else return new Error("Impossibile leggere il contenuto del file.")},o.onerror=()=>new Error("Errore durante la lettura del file."),o.readAsText(n)}export{me as L,re as a};
